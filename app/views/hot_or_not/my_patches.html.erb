<% content_for :title do %>
  Your Patches
<% end %>

<div class="committer-container">
  <div class="committer-header">
    <h1>Your Patches</h1>
    <p class="my-patches-subtitle">
      Patches linked to your GitHub account (<%= @current_user_github_username %>)
    </p>
    <div class="committer-stats-grid">
      <div class="stat-item">
        <span class="stat-value"><%= @committer_stats[:total_patches] %></span>
        <span class="stat-label">Patches</span>
      </div>
      <div class="stat-item">
        <span class="stat-value"><%= @committer_stats[:total_votes] %></span>
        <span class="stat-label">Total Votes</span>
      </div>
      <div class="stat-item">
        <span class="stat-value hot"><%= @committer_stats[:avg_hot_ratio] %>%</span>
        <span class="stat-label">Avg Approval</span>
      </div>
    </div>
  </div>

  <% if @patches.any? %>
    <div class="patch-list">
      <% @patches.each_with_index do |patch, index| %>
        <a href="/hot-or-not/<%= patch.id %>" class="patch-list-item">
          <span class="patch-rank"><%= index + 1 %></span>
          <span class="patch-info">
            <span class="patch-name"><%= patch.title.sub(/^Audit Fix:\s*/i, '').truncate(70) %></span>
            <span class="patch-meta-line">
              <code><%= patch.commit_hash[0..7] %></code>
              <% if patch.issue_type.present? %>
                <span class="badge badge-<%= patch.issue_type %>"><%= patch.issue_type %></span>
              <% end %>
              <% if patch.resolved? %>
                <span class="badge badge-resolution badge-<%= patch.resolution_status %>"><%= patch.resolution_status %></span>
              <% end %>
              <% if patch.audit_date.present? %>
                <span class="patch-date"><%= patch.audit_date.strftime("%Y-%m-%d") %></span>
              <% end %>
            </span>
          </span>
          <% if patch.hot_count + patch.not_count > 0 %>
            <span class="patch-score hot"><%= patch.hot_ratio %>%</span>
          <% else %>
            <span class="patch-score unrated">-</span>
          <% end %>
        </a>
      <% end %>
    </div>
  <% else %>
    <p class="empty-message">No patches found linked to your GitHub account.</p>
  <% end %>

  <div class="committer-actions">
    <a href="/hot-or-not/leaderboard" class="btn-secondary">Back to Leaderboard</a>
    <% if @user_stats[:remaining] > 0 %>
      <a href="/hot-or-not" class="btn-primary">Rate Patches</a>
    <% end %>
  </div>
</div>
